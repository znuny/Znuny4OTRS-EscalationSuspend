image: registry.znuny.com/znuny/docker-otrs6ci:latest

before_script:
  - env
  - pwd
  - /run.sh
  - su -c "/opt/otrs/bin/otrs.Console.pl Znuny4OTRS::AdvancedPackageManager::InstallSOPM /opt/otrs/Znuny4OTRS-EscalationSuspend.sopm" -s /bin/bash otrs

services:
  - name: registry.znuny.com/znuny/docker-mysql-utf8:latest
    alias: mysql

stages:
  - test

job_unit_otrs_Znuny4OTRSEscalationSuspend:
  stage: test
  script:
    - su -c "perl /opt/otrs/bin/otrs.Console.pl Dev::UnitTest::Run --verbose --test Znuny4OTRSEscalationSuspend/EscalationSuspend" -s /bin/bash otrs
    - su -c "perl /opt/otrs/bin/otrs.Console.pl Dev::UnitTest::Run --verbose --test Znuny4OTRSEscalationSuspend/EscalationSuspendLoop" -s /bin/bash otrs
